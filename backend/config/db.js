const {Sequelize} = require('sequelize');
const { generateTimestamps } = require('./utils');

require("dotenv").config();

const connection = new Sequelize({
    dialect: process.env.DB_DRIVER, // Change this to your database type
    host: process.env.DB_HOST,
    port: process.env.DB_PORT, // Change this to your database port
    username: process.env.DB_USER,
    password: process.env.DB_PASSWORD,
    database: process.env.DB_NAME,
    define: {
        // Change the default names for timestamps globally
        timestamps: true, // Enable timestamps by default
        createdAt: 'created_at', // Change the default createdAt column name
        updatedAt: 'updated_at' // Change the default updatedAt column name
    }
});

// Add hooks for globally formatting timestamps
// connection.afterDefine((attributes, options) => {
//     // Include timestamps generated by the utility function for all models
//     const timestamps = generateTimestamps();
//     Object.assign(attributes, timestamps);
// });

// Check the database connection
connection.authenticate()
    .then(() => {
        console.log('Connection to the database has been established successfully.');
    })
    .catch((error) => {
        console.error('Unable to connect to the database:', error);
    });

module.exports = connection;
